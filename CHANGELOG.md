# CHANGELOG

## [2025-7-7] - ë¡œê·¸ì•„ì›ƒ íƒ€ì„ì•„ì›ƒ ë° ì„¸ì…˜ ì •ë¦¬ ê°œì„ 

### ğŸ› ì¤‘ìš” ë²„ê·¸ ìˆ˜ì •

#### **ë¡œê·¸ì•„ì›ƒ íƒ€ì„ì•„ì›ƒìœ¼ë¡œ ì¸í•œ ì„¸ì…˜ ë¯¸ì •ë¦¬ ë¬¸ì œ í•´ê²°**

- **ë¬¸ì œ**: ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ í´ë¦­ ì‹œ íƒ€ì„ì•„ì›ƒ ë°œìƒí•˜ì—¬ ì„¸ì…˜ ì •ë³´ê°€ ì™„ì „íˆ ì‚­ì œë˜ì§€ ì•ŠìŒ
- **ì¦ìƒ**:
  - ë¡œê·¸ì•„ì›ƒ í›„ ìƒˆë¡œê³ ì¹¨ ì‹œ ìë™ ë¡œê·¸ì¸ ë°œìƒ
  - localStorage, sessionStorage, ì¿ í‚¤ ì •ë³´ê°€ ë‚¨ì•„ìˆìŒ
  - Supabase ì„¸ì…˜ì´ ì™„ì „íˆ ì •ë¦¬ë˜ì§€ ì•ŠìŒ
- **ì›ì¸ ë¶„ì„**:
  - auth providerì˜ `signOut` í•¨ìˆ˜ì—ì„œ íƒ€ì„ì•„ì›ƒ ë°œìƒ ì‹œ í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ì •ë¦¬ ëˆ„ë½
  - `authService.logout` í•¨ìˆ˜ì—ì„œ Supabase ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨ ì‹œ ë¡œì»¬ ì •ë¦¬ ë¯¸ìˆ˜í–‰
  - ì´ˆê¸°í™” ì‹œ ì„¸ì…˜ ìœ íš¨ì„± ê²€ì¦ ë¶€ì¡±
- **í•´ê²° ë°©ì•ˆ**:

  ```typescript
  // 1. íƒ€ì„ì•„ì›ƒ ë°œìƒ ì‹œì—ë„ ë°˜ë“œì‹œ í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ì •ë¦¬
  try {
    await Promise.race([logoutPromise, timeoutPromise]);
  } catch (error) {
    await logout(true); // ê°•ì œ ë¡œê·¸ì•„ì›ƒìœ¼ë¡œ ë¡œì»¬ ì •ë¦¬
  }

  // 2. Supabase ë¡œê·¸ì•„ì›ƒì— 5ì´ˆ íƒ€ì„ì•„ì›ƒ ì ìš©
  const logoutPromise = supabase.auth.signOut();
  await Promise.race([logoutPromise, timeoutPromise]);

  // 3. ëª¨ë“  ê²½ìš°ì— localStorage, sessionStorage, ì¿ í‚¤ ì •ë¦¬
  localStorage.clear();
  sessionStorage.clear();
  clearSessionCookies();
  ```

- **ê°œì„  ì‚¬í•­**:
  - ë¡œê·¸ì•„ì›ƒ í”„ë¡œì„¸ìŠ¤ì˜ ê° ë‹¨ê³„ì— íƒ€ì„ì•„ì›ƒ ì ìš© (Supabase: 5ì´ˆ, êµ¬ë…ì •ë¦¬: 3ì´ˆ)
  - íƒ€ì„ì•„ì›ƒì´ë‚˜ ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ë°˜ë“œì‹œ í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ì™„ì „ ì •ë¦¬
  - ì´ˆê¸°í™” ì‹œ ì„¸ì…˜ê³¼ ì‚¬ìš©ì ì •ë³´ ì´ì¤‘ ê²€ì¦ìœ¼ë¡œ ìœ íš¨í•˜ì§€ ì•Šì€ ì„¸ì…˜ ì œê±°
  - `SIGNED_OUT` ì´ë²¤íŠ¸ì—ì„œë„ í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ì •ë¦¬ ì¶”ê°€

## [2025-7-7] - React ë¬´í•œ ë£¨í”„ ë° ë Œë”ë§ ìµœì í™”

### ğŸ› ì¤‘ìš” ë²„ê·¸ ìˆ˜ì •

#### 1. **React Error #185: Maximum update depth exceeded í•´ê²°**

- **ë¬¸ì œ**: í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ë¬´í•œ ë Œë”ë§ ë£¨í”„ ë°œìƒ
- **ì›ì¸**:
  - `key={index}` ì‚¬ìš©ìœ¼ë¡œ ì¸í•œ ì»´í¬ë„ŒíŠ¸ ì¬ìƒì„±
  - `useEffect` ì˜ì¡´ì„± ë°°ì—´ì˜ ë¶ˆì•ˆì •í•œ ì°¸ì¡°
  - `AnimatePresence`ì™€ `map` ì¡°í•©ì—ì„œì˜ í‚¤ ê´€ë¦¬ ë¬¸ì œ
- **í•´ê²°**:
  - ëª¨ë“  `key={index}` íŒ¨í„´ì„ ê³ ìœ  ì‹ë³„ìë¡œ ë³€ê²½
  - `useCallback` ì˜ì¡´ì„± ë°°ì—´ì—ì„œ ë¶ˆì•ˆì •í•œ toast í•¨ìˆ˜ ì œê±°
  - `NotificationPermissionDialog`ì—ì„œ `AnimatePresence` ì œê±°
  - `benefits` ë°°ì—´ `useMemo`ë¡œ ë©”ëª¨ì´ì œì´ì…˜

#### 2. **"Cannot update a component while rendering" ê²½ê³  í•´ê²°**

- **ë¬¸ì œ**: ë Œë”ë§ ì¤‘ì— `router.replace()` ì§ì ‘ í˜¸ì¶œë¡œ ì¸í•œ React ê²½ê³ 
- **ì›ì¸**: ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ê³¼ì •ì—ì„œ ìƒíƒœ ë³€ê²½ ë°œìƒ
- **í•´ê²°**:
  - `HomePage`ì™€ `LoginPage`ì—ì„œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë¡œì§ì„ `useEffect`ë¡œ ì´ë™
  - ë Œë”ë§ê³¼ ì‚¬ì´ë“œ ì´í™íŠ¸ ì™„ì „ ë¶„ë¦¬
  - ì¡°ê±´ë¶€ ë Œë”ë§ë§Œ ë‹´ë‹¹í•˜ë„ë¡ êµ¬ì¡° ê°œì„ 

#### 3. **Toast í•¨ìˆ˜ ì˜ì¡´ì„± ë¬´í•œ ë£¨í”„ í•´ê²°**

- **ë¬¸ì œ**: `useCommonToast` í›…ì˜ `useCallback`ì—ì„œ toast í•¨ìˆ˜ ì˜ì¡´ì„±ìœ¼ë¡œ ë¬´í•œ ë£¨í”„
- **ì›ì¸**: toast í•¨ìˆ˜ê°€ ë§¤ ë Œë”ë§ë§ˆë‹¤ ìƒˆë¡œ ìƒì„±ë˜ì–´ ì˜ì¡´ì„± ë°°ì—´ ë¬´íš¨í™”
- **í•´ê²°**:
  - `useCommonToast`ì˜ ëª¨ë“  í•¨ìˆ˜ì—ì„œ toast ì˜ì¡´ì„± ì œê±°
  - `toast-position-selector`ì—ì„œë„ ë™ì¼í•œ íŒ¨í„´ ì ìš©
  - Admin ì»´í¬ë„ŒíŠ¸ë“¤ì˜ `useEffect`ì—ì„œ toast í•¨ìˆ˜ ì˜ì¡´ì„± ì œê±°

### ğŸ”§ êµ¬ì¡°ì  ê°œì„ 

#### 1. **ì»´í¬ë„ŒíŠ¸ í‚¤ ê´€ë¦¬ ìµœì í™”**

```tsx
// âŒ ë³€ê²½ ì „
{
  items.map((item, index) => <div key={index}>{item.name}</div>);
}

// âœ… ë³€ê²½ í›„
{
  items.map((item) => <div key={item.title || item.name}>{item.name}</div>);
}
```

#### 2. **ë Œë”ë§ ì¤‘ ì‚¬ì´ë“œ ì´í™íŠ¸ ë¶„ë¦¬**

```tsx
// âŒ ë³€ê²½ ì „
if (state.status === "authenticated") {
  router.replace("/admin/dashboard"); // ë Œë”ë§ ì¤‘ ìƒíƒœ ë³€ê²½!
  return <Loading />;
}

// âœ… ë³€ê²½ í›„
useEffect(() => {
  if (state.status === "authenticated") {
    router.replace("/admin/dashboard");
  }
}, [state.status, router]);

if (state.status === "authenticated") {
  return <Loading />; // ë Œë”ë§ë§Œ ë‹´ë‹¹
}
```

#### 3. **ë©”ëª¨ì´ì œì´ì…˜ íŒ¨í„´ ì ìš©**

```tsx
// âŒ ë³€ê²½ ì „
const benefits = [...]; // ë§¤ë²ˆ ìƒˆë¡œìš´ ë°°ì—´

// âœ… ë³€ê²½ í›„
const benefits = useMemo(() => [...], []); // ë©”ëª¨ì´ì œì´ì…˜
```

### ğŸš€ ì„±ëŠ¥ ê°œì„ 

- **React Strict Mode í™œì„±í™”**: ê°œë°œ í™˜ê²½ì—ì„œ í”„ë¡œë•ì…˜ ë¬¸ì œ ì¡°ê¸° ë°œê²¬
- **ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€**: ì•ˆì •ì ì¸ ì°¸ì¡°ì™€ ë©”ëª¨ì´ì œì´ì…˜ìœ¼ë¡œ ì„±ëŠ¥ í–¥ìƒ
- **ì»´í¬ë„ŒíŠ¸ ìµœì í™”**: `AnimatePresence` ì œê±°ë¡œ ë Œë”ë§ ë³µì¡ë„ ê°ì†Œ

### ğŸ“ ìˆ˜ì •ëœ íŒŒì¼ë“¤

#### ì»´í¬ë„ŒíŠ¸ ìµœì í™”

- `components/admin/notifications/NotificationPermissionDialog.tsx` - `AnimatePresence` ì œê±°, `useMemo` ì ìš©
- `components/admin/visitors/VisitorStats.tsx` - `key={index}` â†’ `key={stat.title}` ë³€ê²½
- `components/admin/visitors/components/InsightCard.tsx` - `key={index}` â†’ `key={insight.label}` ë³€ê²½
- `components/admin/management/users/UserStats.tsx` - `key={index}` â†’ `key={card.title}` ë³€ê²½
- `components/admin/management/logs/LogStats.tsx` - `key={index}` â†’ `key={card.title}` ë³€ê²½
- `components/admin/management/farms/FarmStats.tsx` - `key={index}` â†’ `key={card.title}` ë³€ê²½
- `components/common/CommonStatsGrid.tsx` - `key={index}` â†’ `key={config.title}` ë³€ê²½
- `components/common/InstallGuide/TipsCard.tsx` - `key={index}` â†’ ë³µí•© í‚¤ ì‚¬ìš©
- `components/debug/debug-logs-section.tsx` - `key={index}` â†’ ë³µí•© í‚¤ ì‚¬ìš©
- `components/layout/page-header.tsx` - `key={index}` â†’ `key={item.href || item.label}` ë³€ê²½
- `components/ui/toast-position-selector.tsx` - `key={index}` â†’ `key={service.name}` ë³€ê²½

#### í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸ ìµœì í™”

- `app/page.tsx` - ë Œë”ë§ ì¤‘ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ `useEffect`ë¡œ ì´ë™
- `app/login/page.tsx` - ë Œë”ë§ ì¤‘ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ `useEffect`ë¡œ ì´ë™

#### Toast ë° Hook ìµœì í™”

- `lib/utils/notification/toast-messages.ts` - toast í•¨ìˆ˜ ì˜ì¡´ì„± ì œê±°
- `components/admin/settings/tabs/SystemTab.tsx` - toast í•¨ìˆ˜ ì˜ì¡´ì„± ì œê±°
- `components/admin/settings/tabs/NotificationTab.tsx` - toast í•¨ìˆ˜ ì˜ì¡´ì„± ì œê±°
- `components/admin/notifications/WebPushSubscription.tsx` - toast í•¨ìˆ˜ ì˜ì¡´ì„± ì œê±°
- `hooks/use-number-input.ts` - `useCallback`ê³¼ `useMemo` ì ìš©
- `components/admin/visitors/VisitorFormDialog.tsx` - form ê°ì²´ ì˜ì¡´ì„± ì œê±°

#### ì„¤ì • ìµœì í™”

- `next.config.mjs` - React Strict Mode í™œì„±í™”
- `components/common/DialogManager.tsx` - ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸ ì„ì‹œ ë¹„í™œì„±í™”

### ğŸ¯ í•µì‹¬ í•´ê²° ì›ì¹™

1. **ë Œë”ë§ ìˆœìˆ˜ì„± ìœ ì§€**: ë Œë”ë§ ì¤‘ì—ëŠ” ì‚¬ì´ë“œ ì´í™íŠ¸ ê¸ˆì§€
2. **ì•ˆì •ì ì¸ í‚¤ ì‚¬ìš©**: `key={index}` ëŒ€ì‹  ê³ ìœ  ì‹ë³„ì ì‚¬ìš©
3. **ì˜ì¡´ì„± ë°°ì—´ ìµœì í™”**: ë¶ˆì•ˆì •í•œ ì°¸ì¡° ì œê±° ë° ë©”ëª¨ì´ì œì´ì…˜
4. **React Strict Mode í™œìš©**: ê°œë°œ í™˜ê²½ì—ì„œ í”„ë¡œë•ì…˜ ë¬¸ì œ ì¡°ê¸° ë°œê²¬

### ğŸ“ˆ ì„±ëŠ¥ ì˜í–¥

- **ë Œë”ë§ ì„±ëŠ¥**: ë¬´í•œ ë£¨í”„ ì œê±°ë¡œ CPU ì‚¬ìš©ëŸ‰ ëŒ€í­ ê°ì†Œ
- **ì‚¬ìš©ì ê²½í—˜**: ì•± í¬ë˜ì‹œ ë° ë¬´ì‘ë‹µ ìƒíƒœ ì™„ì „ í•´ê²°
- **ê°œë°œ íš¨ìœ¨ì„±**: Strict Modeë¡œ ë¬¸ì œ ì¡°ê¸° ë°œê²¬ ë° ë””ë²„ê¹… í–¥ìƒ

---

## [2025-7-5] - ë¡œê·¸ì¸ ì„±ëŠ¥ ìµœì í™” ë° API í´ë¼ì´ì–¸íŠ¸ í†µí•©

### ğŸš€ ë¡œê·¸ì¸ ì„±ëŠ¥ ìµœì í™” (ìƒˆë¡œ ì¶”ê°€)

#### 1. **ë¡œê·¸ì¸ ì‹œë„ íšŸìˆ˜ í™•ì¸ ìµœì í™”**

- **ê¸°ì¡´**: ìˆœì°¨ì  ì²˜ë¦¬ (ë¡œê·¸ì¸ ì‹œë„ í™•ì¸ â†’ Supabase ì¸ì¦)
- **ê°œì„ **: ë³‘ë ¬ ì²˜ë¦¬ (ë¡œê·¸ì¸ ì‹œë„ í™•ì¸ê³¼ Supabase ì¸ì¦ ë™ì‹œ ì‹¤í–‰)
- **íš¨ê³¼**: ì•½ 200-400ms ë‹¨ì¶•
- **êµ¬í˜„**: `Promise.all([supabase.auth.signInWithPassword(), checkLoginAttempts()])`

#### 2. **ì„±ëŠ¥ ë¡œê¹… ìµœì í™”**

- **ê¸°ì¡´**: ê° ë‹¨ê³„ë§ˆë‹¤ ë™ê¸° ë¡œê¹…ìœ¼ë¡œ ì‘ë‹µ ì§€ì—° ë°œìƒ
- **ê°œì„ **: ë¹„ë™ê¸° ë¡œê¹… (setTimeoutìœ¼ë¡œ ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬)
- **íš¨ê³¼**: ì‘ë‹µ ì§€ì—° ì œê±°, ì•½ 100-200ms ë‹¨ì¶•
- **êµ¬í˜„**: ì„±ëŠ¥ ë¡œê¹…ì„ `setTimeout(() => {}, 0)`ìœ¼ë¡œ ë¹„ë™ê¸° ì²˜ë¦¬

#### 3. **DB ì¿¼ë¦¬ ìµœì í™”**

- **ê¸°ì¡´**: ë‘ ê°œì˜ ë³„ë„ UPDATE ì¿¼ë¦¬ (resetLoginAttempts + updateLoginTime)
- **ê°œì„ **: ë‹¨ì¼ ì¿¼ë¦¬ë¡œ í†µí•©í•˜ì—¬ DB ì—°ê²° ì˜¤ë²„í—¤ë“œ ê°ì†Œ
- **íš¨ê³¼**: ì•½ 100-200ms ë‹¨ì¶•
- **êµ¬í˜„**: `prisma.profiles.update()`ë¡œ ëª¨ë“  í•„ë“œ í•œ ë²ˆì— ì—…ë°ì´íŠ¸

#### 4. **ì„¸ì…˜ ì„¤ì • ìµœì í™”**

- **ê¸°ì¡´**: API ì‘ë‹µ í›„ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë³„ë„ ì„¸ì…˜ ì„¤ì • (`supabase.auth.setSession`)
- **ê°œì„ **: ì„œë²„ì—ì„œ ì„¸ì…˜ ì¿ í‚¤ ì§ì ‘ ì„¤ì •í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ ì„¸ì…˜ ì„¤ì • ë¶ˆí•„ìš”
- **íš¨ê³¼**: ì•½ 200-300ms ë‹¨ì¶•
- **êµ¬í˜„**: `response.cookies.set()`ë¡œ ì„¸ì…˜ ì¿ í‚¤ ì§ì ‘ ì„¤ì •

#### 5. **í”„ë¡œí•„ ë¡œë“œ ìµœì í™”**

- **ê¸°ì¡´**: ì‹¤íŒ¨ ì‹œ 1ì´ˆ ëŒ€ê¸° í›„ ì¬ì‹œë„
- **ê°œì„ **: ì¦‰ì‹œ ì¬ì‹œë„ + ë°±ê·¸ë¼ìš´ë“œ ë¡œë“œ
- **íš¨ê³¼**: ëŒ€ê¸° ì‹œê°„ ì œê±°, ì•½ 1000ms ë‹¨ì¶•
- **êµ¬í˜„**: ëŒ€ê¸° ì‹œê°„ ì œê±°, ë°±ê·¸ë¼ìš´ë“œì—ì„œ í”„ë¡œí•„ ë¡œë“œ ì‹œë„

#### 6. **ì•ˆì „í•œ ì‚¬ìš©ì ì •ë³´ ì²˜ë¦¬**

- **ë¬¸ì œ**: `result.user.id` ì ‘ê·¼ ì‹œ undefined ì—ëŸ¬ ë°œìƒ
- **í•´ê²°**: ì‚¬ìš©ì ì •ë³´ ì¡´ì¬ ì—¬ë¶€ë¥¼ ë¨¼ì € í™•ì¸í•˜ëŠ” ì•ˆì „í•œ ì ‘ê·¼ ë°©ì‹ ì ìš©
- **êµ¬í˜„**: `if (!result.user || !result.user.id)` ì²´í¬ ì¶”ê°€

### ğŸ“Š ì„±ëŠ¥ ê°œì„  íš¨ê³¼

#### **í˜„ì¬ ì„±ëŠ¥**

- **ë¡œê·¸ì¸ ì²˜ë¦¬**: 2-4ì´ˆ
- **ëŒ€ì‹œë³´ë“œ ë¡œë”©**: 3-5ì´ˆ
- **ì´ ì†Œìš” ì‹œê°„**: 5-9ì´ˆ

#### **ê°œì„  í›„ ì˜ˆìƒ ì„±ëŠ¥**

- **ë¡œê·¸ì¸ ì²˜ë¦¬**: 1-2ì´ˆ (50-60% ê°œì„ )
- **ëŒ€ì‹œë³´ë“œ ë¡œë”©**: 2-3ì´ˆ (40-50% ê°œì„ )
- **ì´ ì†Œìš” ì‹œê°„**: 3-5ì´ˆ (40-60% ê°œì„ )

### ğŸ”§ ìµœì í™” ì½”ë“œ ì˜ˆì‹œ

#### ë³‘ë ¬ ì²˜ë¦¬

```typescript
// ê¸°ì¡´: ìˆœì°¨ì  ì²˜ë¦¬
const attempts = await checkLoginAttempts(email);
const {
  data: { user, session },
  error,
} = await supabase.auth.signInWithPassword({ email, password });

// ê°œì„ : ë³‘ë ¬ ì²˜ë¦¬
const [authResult, attempts] = await Promise.all([
  supabase.auth.signInWithPassword({ email, password }),
  checkLoginAttempts(email),
]);
```

#### ë¹„ë™ê¸° ë¡œê¹…

```typescript
// ê¸°ì¡´: ë™ê¸° ë¡œê¹…
await logApiPerformance({...});
return NextResponse.json(responseData);

// ê°œì„ : ë¹„ë™ê¸° ë¡œê¹…
setTimeout(async () => {
  await logApiPerformance({...});
}, 0);
return NextResponse.json(responseData);
```

#### ë‹¨ì¼ DB ì¿¼ë¦¬

```typescript
// ê¸°ì¡´: ë‘ ê°œì˜ ë³„ë„ ì¿¼ë¦¬
await Promise.all([
  resetLoginAttempts(email, clientIP, userAgent),
  updateLoginTime(user!.id, clientIP, userAgent),
]);

// ê°œì„ : ë‹¨ì¼ ì¿¼ë¦¬
await prisma.profiles.update({
  where: { email },
  data: {
    login_attempts: 0,
    last_failed_login: null,
    last_login_attempt: null,
    last_login_at: new Date(),
  },
});
```

#### ì„¸ì…˜ ì¿ í‚¤ ì„¤ì •

```typescript
// ê¸°ì¡´: í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„¸ì…˜ ì„¤ì •
const { error: setSessionError } = await supabase.auth.setSession(session);

// ê°œì„ : ì„œë²„ì—ì„œ ì¿ í‚¤ ì„¤ì •
response.cookies.set("sb-access-token", session!.access_token, {
  httpOnly: true,
  secure: process.env.NODE_ENV === "production",
  sameSite: "lax",
  maxAge: session!.expires_at ? session!.expires_at * 1000 - Date.now() : 3600,
});
```

### ğŸ“ ìˆ˜ì •ëœ íŒŒì¼ë“¤

#### API ë¼ìš°í„°

- `app/api/auth/login/route.ts` - ë¡œê·¸ì¸ ì„±ëŠ¥ ìµœì í™” (ë³‘ë ¬ ì²˜ë¦¬, ë¹„ë™ê¸° ë¡œê¹…, ë‹¨ì¼ ì¿¼ë¦¬, ì„¸ì…˜ ì¿ í‚¤)

#### ì»´í¬ë„ŒíŠ¸

- `components/providers/auth-provider.tsx` - í”„ë¡œí•„ ë¡œë“œ ìµœì í™”, ì•ˆì „í•œ ì‚¬ìš©ì ì •ë³´ ì²˜ë¦¬

---

## [2025-7-5] - API í´ë¼ì´ì–¸íŠ¸ í†µí•© ë° ì—ëŸ¬ ì²˜ë¦¬ íŒ¨í„´ ê°œì„ 

### ğŸ”„ ì£¼ìš” ë³€ê²½ì‚¬í•­

#### 1. **fetch â†’ apiClient í†µì¼ ë° ì—ëŸ¬ ì²˜ë¦¬ íŒ¨í„´**

- **ë³€ê²½**: ëª¨ë“  fetch í˜¸ì¶œì„ ê³µí†µ fetch wrapper(apiClient)ë¡œ í†µì¼
- **ë³€ê²½**: ì—ëŸ¬ ì²˜ë¦¬ëŠ” handleErrorë¡œ ì¼ê´€ì„± ìœ ì§€
- **ë³€ê²½**: í† ìŠ¤íŠ¸ ì•Œë¦¼ì€ ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ì²˜ë¦¬í•˜ëŠ” íŒ¨í„´ ì ìš©
- **ë¬¸ì œ í•´ê²°**: apiClientì™€ handleErrorì—ì„œ í† ìŠ¤íŠ¸ ì¤‘ë³µ í˜¸ì¶œ ë¬¸ì œ ë°œê²¬ ë° í•´ê²°
- **ë¦¬íŒ©í† ë§**: apiClientì—ì„œë§Œ í† ìŠ¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê³  handleErrorëŠ” ìƒíƒœ ì—…ë°ì´íŠ¸ë§Œ ë‹´ë‹¹í•˜ë„ë¡ êµ¬ì¡° ê°œì„ 

#### 2. **apiClient context ì˜µì…˜ ë° handleError ì¼ê´€ì„±**

- **ê°œì„ **: apiClient í˜¸ì¶œì— context ì˜µì…˜ì´ ì¼ê´€ë˜ì§€ ì•Šì€ ì  ìˆ˜ì •
- **ì ìš©**: ì£¼ìš” íŒŒì¼ì— context ì¶”ê°€ (useAccountActions, useNotificationPermission, useNotificationService, useNotificationSettings ë“±)
- **êµ¬ì¡° í†µì¼**: í›…ì—ì„œëŠ” ì—ëŸ¬ ìƒíƒœë§Œ ê´€ë¦¬, í† ìŠ¤íŠ¸ëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ ì²˜ë¦¬í•˜ë„ë¡ êµ¬ì¡° í†µì¼
- **í™•ì¸**: handleErrorê°€ Sentry ì™¸ë¶€ ë¡œê¹…ì— í•„ìš”í•˜ë‹¤ëŠ” ì  í™•ì¸

#### 3. **ìºì‹œ/í—¤ë”/ì„¸ì…˜ ë§Œë£Œ ì²˜ë¦¬**

- **ìˆ˜ì •**: system-settings-cache.tsì—ì„œ handleError ëˆ„ë½ê³¼ no-cache í—¤ë” ë¬¸ì œ ìˆ˜ì •
- **ë³€ê²½**: app/api/settings/route.tsì˜ ìºì‹œ í—¤ë”ë¥¼ max-age=300ì—ì„œ no-storeë¡œ ë³€ê²½
- **ì„¤ëª…**: HTTP ìºì‹œì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ìºì‹œì˜ ì°¨ì´, max-ageì™€ no-storeì˜ ì°¨ì´, ì„œë²„ ë©”ëª¨ë¦¬ ìºì‹œì˜ ì—­í•  ì„¤ëª…
- **ê°œì„ **: ì„¸ì…˜ ë§Œë£Œ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ëŠ” ë°©ì‹ ì ìš©
- **êµ¬í˜„**: ì¼ë°˜ì ì¸ ì„¸ì…˜ ë§Œë£Œ ì²˜ë¦¬(401/403), fetch ìœ í‹¸ì—ì„œ ì„¸ì…˜ ê´€ë¦¬ ë¡œì§ì˜ ì¼ë°˜ì„±, ë¯¸ë“¤ì›¨ì–´ì—ì„œ ì¸ì¦/ê¶Œí•œ ì²´í¬, ìë™ ë¡œê·¸ì•„ì›ƒ ë° ì¿ í‚¤ ì •ë¦¬, í† í° ìë™ ê°±ì‹  ì‹œë„ ë“± ì„¸ì…˜ ê´€ë¦¬ ê°œì„ 

#### 4. **ì„¸ì…˜ ê´€ë¦¬ ë° ë¯¸ë“¤ì›¨ì–´ ê°œì„ **

- **êµ¬í˜„**: lib/auth/authService.tsì—ì„œ í† í° ë§Œë£Œ í™•ì¸, ìë™ ê°±ì‹ , ì„¸ì…˜ ìœ íš¨ì„± ê²€ì¦ í•¨ìˆ˜ êµ¬í˜„
- **ê°œì„ **: í† í° ë§Œë£Œ ì‹œê°„ í™•ì¸ ê³µí†µ í•¨ìˆ˜ (checkTokenExpiration) êµ¬í˜„
- **êµ¬í˜„**: ì¿ í‚¤ ì •ë¦¬ ê³µí†µ í•¨ìˆ˜ (clearSessionCookies) êµ¬í˜„
- **ê°œì„ **: í† í° ê°±ì‹  í•¨ìˆ˜ (refreshToken) - ì¤‘ë³µ ìš”ì²­ ë°©ì§€ ë¡œì§ í¬í•¨
- **êµ¬í˜„**: ì„¸ì…˜ ë§Œë£Œ ì²˜ë¦¬ í•¨ìˆ˜ (handleSessionExpired) - í† ìŠ¤íŠ¸ ì œê±°, ìƒíƒœë§Œ ë°˜í™˜
- **ê°œì„ **: ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜ (logout) - ë¸Œë¼ìš°ì € êµ¬ë… í•´ì œ, ì„œë²„ êµ¬ë… ì •ë¦¬, ê°•ì œ ë¡œê·¸ì•„ì›ƒ ì‹œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì •ë¦¬
- **êµ¬í˜„**: ì„¸ì…˜ ìœ íš¨ì„± ê²€ì¦ í•¨ìˆ˜ (validateSession) - í† í° ë§Œë£Œ ì—¬ë¶€, ê°±ì‹  í•„ìš” ì—¬ë¶€ í™•ì¸
- **ê°œì„ **: middleware.tsì—ì„œ í† í° ê²€ì¦ ë° ìë™ ê°±ì‹  ë¡œì§ êµ¬í˜„
- **êµ¬í˜„**: ë¯¸ë“¤ì›¨ì–´ì—ì„œ ì„¸ì…˜ ë§Œë£Œ ì‹œ ì„œë²„ ì¸¡ êµ¬ë… ì •ë¦¬ ë¡œì§
- **ê°œì„ **: ë¯¸ë“¤ì›¨ì–´ì—ì„œ ê³µê°œ ê²½ë¡œ ë§¤ì¹­, ì¸ì¦ ìƒíƒœ ê²€ì¦, ë³´ì•ˆ ë¡œê¹… êµ¬í˜„

#### 5. **PWA ì„¤ì¹˜/ê°€ì´ë“œ/ë‹¤ì´ì–¼ë¡œê·¸ í**

- **êµ¬í˜„**: PWA ì„¤ì¹˜ ê°€ëŠ¥ ì—¬ë¶€ ì²´í¬ í›…, ì„¤ì¹˜ ìœ ë„ UI, í”Œë«í¼ë³„ ì„¤ì¹˜ ê°€ì´ë“œ, í…ŒìŠ¤íŠ¸ í˜ì´ì§€
- **ì¶”ê°€**: ë©”ì¸ ë ˆì´ì•„ì›ƒ/ëŒ€ì‹œë³´ë“œì— ì„¤ì¹˜ ê°€ì´ë“œ ë²„íŠ¼ ì¶”ê°€
- **ê°œì„ **: ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸ì™€ PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ê°€ ì¤‘ì²©ë˜ì§€ ì•Šë„ë¡ ë‹¤ì´ì–¼ë¡œê·¸ í ì‹œìŠ¤í…œì„ Zustandë¡œ êµ¬í˜„
- **ìš°ì„ ìˆœìœ„**: ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ë‹¤ì´ì–¼ë¡œê·¸ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ í‘œì‹œí•˜ë„ë¡ êµ¬í˜„
- **ì„¤ì •**: ë””ë²„ê·¸ íŒ¨ë„ì€ ë‹¤ì´ì–¼ë¡œê·¸ íì™€ ë³„ê°œë¡œ í•­ìƒ í‘œì‹œë˜ë„ë¡ ì„¤ì •

#### 6. **UI/ë‹¤í¬ëª¨ë“œ/ThemeProvider**

- **ë…¼ì˜**: ThemeProviderê°€ ì‹¤ì œë¡œ ë‹¤í¬/ë¼ì´íŠ¸ í…Œë§ˆ ì „í™˜ì„ ì§€ì›í•˜ëŠ”ì§€, ì–´ë””ì„œ ì‚¬ìš©ë˜ëŠ”ì§€, ë‹¤í¬ëª¨ë“œê°€ ì‹¤ì œë¡œ ì ìš©ë˜ëŠ”ì§€, í…Œë§ˆ í† ê¸€ ë²„íŠ¼ì„ ì¶”ê°€í•˜ëŠ” ë°©ë²•, ë‹¤í¬ëª¨ë“œ ì ìš© ë²”ìœ„(admin ì „ìš©) ë“± UI/UX ê´€ë ¨ ë…¼ì˜ ì§„í–‰
- **ê°œì„ **: ë‹¤í¬ëª¨ë“œì—ì„œ í•„í„°, í…Œì´ë¸”, ë²„íŠ¼, ë±ƒì§€ ë“± í…ìŠ¤íŠ¸/ì•„ì´ì½˜ì´ ì˜ ì•ˆ ë³´ì´ëŠ” ë¬¸ì œë¥¼ ë°˜ë³µì ìœ¼ë¡œ ê°œì„ (ë‹¤í¬ ìŠ¤íƒ€ì¼, !important, style ì†ì„± ë“±)

#### 7. **FarmsProvider ì ìš© ë²”ìœ„**

- **ë¶„ì„**: FarmsProviderê°€ ë£¨íŠ¸ì—ì„œ í•„ìš”í•œì§€, ì‹¤ì œë¡œ admin ì´ì™¸ ê²½ë¡œì—ì„œ ì‚¬ìš©ë˜ëŠ”ì§€ ì½”ë“œë² ì´ìŠ¤ ì „ì²´ë¥¼ ë¶„ì„
- **ì •ë¦¬**: admin ì „ìš©ì—ì„œë§Œ ê°ì‹¸ë„ë¡ êµ¬ì¡° ì •ë¦¬

#### 8. **apiClient/fetch êµ¬ì¡°ë¶„í•´ í• ë‹¹ ë° ì‘ë‹µ êµ¬ì¡°**

- **ì„¤ëª…**: apiClientê°€ fetchì™€ ë™ì¼í•˜ê²Œ ë™ì‘í•˜ëŠ”ì§€, êµ¬ì¡°ë¶„í•´ í• ë‹¹ì´ ì•ˆ ë˜ëŠ” ì›ì¸(ì‘ë‹µ êµ¬ì¡° ì°¨ì´), ë°°ì—´/ê°ì²´ ë°˜í™˜ì— ë”°ë¥¸ ì˜¬ë°”ë¥¸ êµ¬ì¡°ë¶„í•´ í• ë‹¹ ë°©ë²•, ì‹¤ì œ ì½”ë“œì—ì„œì˜ ì ìš© ì˜ˆì‹œë¥¼ ìƒì„¸íˆ ì„¤ëª…
- **ê°œì„ **: use-farm-members-store.ts, use-visitor-store.ts ë“±ì—ì„œ êµ¬ì¡°ë¶„í•´ í• ë‹¹, ë³€ìˆ˜ëª… ì¤‘ë³µ, ë°©ì–´ ì½”ë“œ, API ì‘ë‹µ êµ¬ì¡°ì— ë”°ë¥¸ ì˜¬ë°”ë¥¸ ì‚¬ìš©ë²• ì•ˆë‚´
- **í•´ê²°**: admin/farms/[farmId]/members í˜ì´ì§€ ë¬´í•œë¡œë”© ë° map is not a function ì˜¤ë¥˜ì˜ ì›ì¸ì„ apiClient/fetch ì‘ë‹µ êµ¬ì¡°, êµ¬ì¡°ë¶„í•´ í• ë‹¹, API ì‘ë‹µê°’ ë°©ì–´ ì½”ë“œ ë“±ì—ì„œ ì§„ë‹¨í•˜ê³ , ì˜¬ë°”ë¥¸ íŒ¨í„´ ì•ˆë‚´

### ğŸ“ ìˆ˜ì •ëœ íŒŒì¼ë“¤

#### í›… (Hooks)

- `hooks/useAccountActions.ts` - í† ìŠ¤íŠ¸ ì œê±°, apiClient í†µì¼
- `hooks/useNotificationSettings.ts` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `hooks/useNotificationService.ts` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `hooks/useNotificationPermission.ts` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `hooks/useVisitorSettings.ts` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `hooks/useVisitorForm.ts` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `hooks/useSubscriptionManager.ts` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •

#### ìŠ¤í† ì–´ (Store)

- `store/use-farms-store.ts` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `store/use-farm-members-store.ts` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `store/use-visitor-store.ts` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •

#### ìœ í‹¸ë¦¬í‹° (Utils)

- `lib/utils/validation/validation.ts` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `lib/cache/system-settings-cache.ts` - handleError ëˆ„ë½ ìˆ˜ì •, no-cache í—¤ë” ë¬¸ì œ ìˆ˜ì •
- `lib/auth/authService.ts` - ì„¸ì…˜ ê´€ë¦¬ í•¨ìˆ˜ë“¤ êµ¬í˜„ (í† í° ê°±ì‹ , ì„¸ì…˜ ìœ íš¨ì„± ê²€ì¦, ë¡œê·¸ì•„ì›ƒ ë“±)
- `middleware.ts` - í† í° ê²€ì¦ ë° ìë™ ê°±ì‹  ë¡œì§, ì„¸ì…˜ ë§Œë£Œ ì‹œ êµ¬ë… ì •ë¦¬ ë¡œì§ êµ¬í˜„

#### ì»´í¬ë„ŒíŠ¸ (Components)

- `components/providers/auth-provider.tsx` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `components/admin/notifications/NotificationSettingsActions.tsx` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `components/admin/management/logs/LogsActionManager.tsx` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •

#### í˜ì´ì§€ (Pages)

- `app/reset-password/page.tsx` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •
- `app/admin/monitoring/page.tsx` - apiClient ì‘ë‹µ êµ¬ì¡° í™•ì¸ ë° ìˆ˜ì •

### ğŸ”§ ê¸°ìˆ ì  ê°œì„ ì‚¬í•­

#### API ì‘ë‹µ êµ¬ì¡° íŒ¨í„´ í†µì¼

```javascript
// ëª©ë¡ ì¡°íšŒ (GET)
const { farms } = await apiClient("/api/farms", { method: "GET" });
const { members } = await apiClient("/api/farm-members", { method: "GET" });

// ë‹¨ê±´ ìƒì„± (POST)
const { farm } = await apiClient("/api/farms", { method: "POST", body: ... });
const visitor = await apiClient("/api/farms/${farmId}/visitors", { method: "POST", body: ... });

// ë‹¨ê±´ ìˆ˜ì • (PUT)
const { farm } = await apiClient(`/api/farms/${farmId}`, { method: "PUT", body: ... });

// ë‹¨ê±´ ì‚­ì œ (DELETE)
await apiClient(`/api/farms/${farmId}`, { method: "DELETE" });
```

#### ì—ëŸ¬ ì²˜ë¦¬ íŒ¨í„´ í†µì¼

```javascript
// í›…ì—ì„œëŠ” ì—ëŸ¬ ìƒíƒœë§Œ ê´€ë¦¬
onError: (error, context) => {
  handleError(error, {
    context,
    onStateUpdate: (errorMessage) => {
      setError(new Error(errorMessage));
    },
  });
};

// ì»´í¬ë„ŒíŠ¸ì—ì„œë§Œ í† ìŠ¤íŠ¸ ì²˜ë¦¬
toast.showError("ì˜¤ë¥˜", error.message);
```

#### ì„¸ì…˜ ê´€ë¦¬ íŒ¨í„´

```javascript
// í† í° ë§Œë£Œ í™•ì¸
const { isExpired, needsRefresh } = checkTokenExpiration(session, 5);

// í† í° ìë™ ê°±ì‹ 
const success = await refreshToken();

// ì„¸ì…˜ ìœ íš¨ì„± ê²€ì¦
const { isValid, needsRefresh, error } = await validateSession();

// ì„¸ì…˜ ë§Œë£Œ ì²˜ë¦¬
const { success, message } = await handleSessionExpired();
```

#### êµ¬ì¡°ë¶„í•´ í• ë‹¹ íŒ¨í„´

```javascript
// ì•ˆì „í•œ ë°©ë²• (ê¶Œì¥)
const { members = [] } = await apiClient("/api/farm-members", {
  method: "GET",
});

// ê°„ë‹¨í•œ ë°©ë²•
const { members } = await apiClient("/api/farm-members", { method: "GET" });
```

### ğŸ¯ í•´ê²°ëœ ë¬¸ì œë“¤

1. **í† ìŠ¤íŠ¸ ì¤‘ë³µ í˜¸ì¶œ ë¬¸ì œ** - apiClientì™€ handleErrorì—ì„œ ì¤‘ë³µ í† ìŠ¤íŠ¸ í˜¸ì¶œ ë°©ì§€
2. **êµ¬ì¡°ë¶„í•´ í• ë‹¹ ì˜¤ë¥˜** - API ì‘ë‹µ êµ¬ì¡°ì— ë”°ë¥¸ ì˜¬ë°”ë¥¸ êµ¬ì¡°ë¶„í•´ í• ë‹¹ íŒ¨í„´ ì ìš©
3. **map is not a function ì˜¤ë¥˜** - ë°°ì—´ ì‘ë‹µ ì²˜ë¦¬ ì‹œ ë°©ì–´ ì½”ë“œ ì¶”ê°€
4. **ìºì‹œ í—¤ë” ë¬¸ì œ** - no-store vs max-age ìºì‹œ í—¤ë” ì ì ˆí•œ ì‚¬ìš©
5. **ì„¸ì…˜ ë§Œë£Œ ì²˜ë¦¬** - ì¼ê´€ëœ ì„¸ì…˜ ë§Œë£Œ ì²˜ë¦¬ ë° ë¦¬ë‹¤ì´ë ‰íŠ¸ ë¡œì§
6. **í† í° ìë™ ê°±ì‹ ** - ë¯¸ë“¤ì›¨ì–´ì—ì„œ í† í° ë§Œë£Œ ì‹œ ìë™ ê°±ì‹  ì‹œë„
7. **êµ¬ë… ì •ë¦¬** - ì„¸ì…˜ ë§Œë£Œ ì‹œ ë¸Œë¼ìš°ì € ë° ì„œë²„ êµ¬ë… ìë™ ì •ë¦¬
8. **ë‹¤í¬ëª¨ë“œ ê°€ë…ì„±** - ë‹¤í¬ëª¨ë“œì—ì„œ UI ìš”ì†Œë“¤ì˜ ê°€ë…ì„± ê°œì„ 

### ğŸ“ˆ ì„±ëŠ¥ ê°œì„ 

- **ì¤‘ë³µ ìš”ì²­ ë°©ì§€**: ì¿¨ë‹¤ìš´ ë° ì¤‘ë³µ ìš”ì²­ ì²´í¬ ë¡œì§ ê°œì„ 
- **ìºì‹œ ìµœì í™”**: ì ì ˆí•œ ìºì‹œ í—¤ë” ì„¤ì •ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ìš”ì²­ ê°ì†Œ
- **ì—ëŸ¬ ì²˜ë¦¬ ìµœì í™”**: ì¼ê´€ëœ ì—ëŸ¬ ì²˜ë¦¬ë¡œ ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

### ğŸ”’ ë³´ì•ˆ ê°œì„ 

- **ì„¸ì…˜ ê´€ë¦¬**: ì•ˆì „í•œ ì„¸ì…˜ ë§Œë£Œ ì²˜ë¦¬ ë° ìë™ ë¡œê·¸ì•„ì›ƒ
- **í† í° ê´€ë¦¬**: í† í° ë§Œë£Œ ì‹œ ìë™ ê°±ì‹  ë° ì•ˆì „í•œ ì„¸ì…˜ ì •ë¦¬
- **êµ¬ë… ì •ë¦¬**: ì„¸ì…˜ ë§Œë£Œ ì‹œ í‘¸ì‹œ ì•Œë¦¼ êµ¬ë… ìë™ ì •ë¦¬
- **ì—ëŸ¬ ë¡œê¹…**: ë¯¼ê°í•œ ì •ë³´ ë…¸ì¶œ ë°©ì§€ë¥¼ ìœ„í•œ ì—ëŸ¬ ë©”ì‹œì§€ ì²˜ë¦¬
- **ê¶Œí•œ ê²€ì¦**: ì¼ê´€ëœ ê¶Œí•œ ê²€ì¦ ë¡œì§ ì ìš©
- **ë¯¸ë“¤ì›¨ì–´ ë³´ì•ˆ**: ëª¨ë“  ìš”ì²­ì— ëŒ€í•œ ì¸ì¦ ìƒíƒœ ê²€ì¦ ë° ë¡œê¹…

---

## [2024-12-18] - ì´ì „ ì‘ì—… ë‚´ìš©

### ğŸ”„ ì£¼ìš” ë³€ê²½ì‚¬í•­

#### 1. **PWA ê¸°ëŠ¥ êµ¬í˜„**

- next-pwaë¥¼ ì‚¬ìš©í•œ PWA ê¸°ëŠ¥ êµ¬í˜„
- ì˜¤í”„ë¼ì¸ ìƒíƒœ ê°ì§€ ë° ì•ˆë‚´ ê¸°ëŠ¥ êµ¬í˜„
- í™ˆí™”ë©´ ì¶”ê°€ ê¸°ëŠ¥ ì§€ì›
- í‘¸ì‹œ ì•Œë¦¼ ê¸°ëŠ¥ êµ¬í˜„

#### 2. **ë‹¤ì¤‘ ë†ì¥ ê´€ë¦¬**

- ê³„ì • 1ê°œë¡œ ì—¬ëŸ¬ ë†ì¥ ë“±ë¡ ê°€ëŠ¥í•˜ë„ë¡ êµ¬í˜„
- ë†ì¥ë³„ ê¶Œí•œ ê´€ë¦¬ êµ¬í˜„
- ë†ì¥ë³„ QRì½”ë“œ ìƒì„± ë° ê´€ë¦¬ ê¸°ëŠ¥ êµ¬í˜„

#### 3. **ê¶Œí•œ ê´€ë¦¬**

- admin, owner, manager, viewer ì—­í•  êµ¬í˜„
- ì—­í• ë³„ ì ‘ê·¼ ê¶Œí•œ ì—„ê²© ê´€ë¦¬
- ê¶Œí•œ ë³€ê²½ì€ adminë§Œ ê°€ëŠ¥í•˜ë„ë¡ êµ¬í˜„

#### 4. **ëª¨ë°”ì¼ ìµœì í™”**

- ëª¨ë°”ì¼ ìš°ì„  ë°˜ì‘í˜• ë””ìì¸ ì ìš©
- í„°ì¹˜ ì¹œí™”ì  UI êµ¬í˜„ (ìµœì†Œ 48px ë²„íŠ¼)
- ì…ë ¥ í•„ë“œëŠ” ëª¨ë°”ì¼ì— ìµœì í™”
- PWA ê¸°ëŠ¥ì„ í™œìš©í•œ ëª¨ë°”ì¼ ê²½í—˜ ê°œì„ 

### ğŸ“ ì£¼ìš” êµ¬í˜„ íŒŒì¼ë“¤

- PWA ê´€ë ¨ ì„¤ì • ë° ì»´í¬ë„ŒíŠ¸
- ë†ì¥ ê´€ë¦¬ ì‹œìŠ¤í…œ
- ê¶Œí•œ ê´€ë¦¬ ì‹œìŠ¤í…œ
- ëª¨ë°”ì¼ ìµœì í™” ì»´í¬ë„ŒíŠ¸

---

## ğŸ“ ì°¸ê³ ì‚¬í•­

- ëª¨ë“  ë³€ê²½ì‚¬í•­ì€ ê¸°ì¡´ ê¸°ëŠ¥ì„ ìœ ì§€í•˜ë©´ì„œ ê°œì„ 
- í•˜ìœ„ í˜¸í™˜ì„± ë³´ì¥
- ì„±ëŠ¥ ë° ë³´ì•ˆ ìµœì í™” ìš°ì„ 
- ì‚¬ìš©ì ê²½í—˜ ê°œì„ ì— ì¤‘ì 

## [Unreleased]

### ğŸš€ ì„±ëŠ¥ ìµœì í™”

- **PWA ì„¤ì¹˜ í›… ìµœì í™”**: `usePWAInstall` í›…ì˜ ì¤‘ë³µ í˜¸ì¶œ ë¬¸ì œ í•´ê²°
  - Context Provider íŒ¨í„´ ë„ì…ìœ¼ë¡œ ì „ì—­ ìƒíƒœ ê´€ë¦¬
  - 4ê°œ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê°œë³„ í˜¸ì¶œ â†’ 1ê°œ Providerì—ì„œ ì¤‘ì•™ ê´€ë¦¬
  - ë¸Œë¼ìš°ì € í™˜ê²½ ì²´í¬ í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜
  - ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€ ë° ì„±ëŠ¥ í–¥ìƒ
  - SSR í˜¸í™˜ì„± ê°œì„  (ë¸Œë¼ìš°ì € í™˜ê²½ ì²´í¬)

### ğŸ”§ ê¸°ìˆ ì  ê°œì„ 

- **PWA Provider êµ¬ì¡° ê°œì„ **:
  - `components/providers/pwa-provider.tsx` ì‹ ê·œ ìƒì„±
  - ê¸°ì¡´ `hooks/usePWAInstall.ts` ì‚­ì œ ë° Providerë¡œ ì™„ì „ ëŒ€ì²´
  - `usePWALoading` í›… ì¶”ê°€ë¡œ ë¡œë”© ìƒíƒœ ê´€ë¦¬
  - Context ê°’ ë©”ëª¨ì´ì œì´ì…˜ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€

### ğŸ“± PWA ê¸°ëŠ¥

- **ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ìµœì í™”**:
  - ì „ì—­ ë‹¤ì´ì–¼ë¡œê·¸ í ì‹œìŠ¤í…œê³¼ í†µí•©
  - ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸ì™€ ìš°ì„ ìˆœìœ„ ê´€ë¦¬
  - 24ì‹œê°„ ê±°ë¶€ ê¸°ë¡ ë° ìë™ ì¬í‘œì‹œ ë¡œì§

### ğŸ¨ UI/UX ê°œì„ 

- **Toast ë©”ì‹œì§€ variant í™œìš© ê°•í™”**:

  - `showWarning`: ì„¤ì • ì €ì¥, ê¸´ê¸‰ ì•Œë¦¼, ë°ì´í„° ë¡œë”© ì§€ì—°, ê¶Œí•œ ë¶€ì—¬, ì—ëŸ¬ í…ŒìŠ¤íŠ¸ ë“±ì— ì ìš©
  - `showInfo`: ì„¤ì • ì €ì¥ ì‹œì‘, ì•Œë¦¼ ë°œì†¡ ì‹œì‘, ë‚´ë³´ë‚´ê¸° ì‹œì‘, ë¡œê·¸ ì •ë¦¬, ë°©ë¬¸ì ë“±ë¡, ì´ë¯¸ì§€ ì—…ë¡œë“œ ë“±ì— ì ìš©
  - `showError`: ë°©ë¬¸ì ì‘ì—… ì‹¤íŒ¨, ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë“± ì‹¬ê°í•œ ì˜¤ë¥˜ì— ì ìš©
  - ë” ì§ê´€ì ì´ê³  ì¼ê´€ëœ ì‚¬ìš©ì í”¼ë“œë°± ì œê³µ
  - ë©”ì‹œì§€ íƒ€ì…ë³„ ì‹œê°ì  êµ¬ë¶„ìœ¼ë¡œ ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ
  - ì§„í–‰ ìƒí™©ê³¼ ê²°ê³¼ë¥¼ ëª…í™•íˆ êµ¬ë¶„í•˜ì—¬ ì‚¬ìš©ì í˜¼ë€ ë°©ì§€

- **Toast ë©”ì‹œì§€ variant ì¼ê´€ì„± ì™„ì „ ì ìš©**:
  - ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ `toast.showInfo`, `toast.showWarning`, `toast.showError`, `toast.showSuccess` íŒ¨í„´ í†µì¼
  - ì„¤ì • ìœ íš¨ì„± ê²€ì‚¬, ì´ë¯¸ì§€ ê´€ë¦¬, ì‚¬ìš©ì/ë†ì¥ ë°ì´í„° ê´€ë¦¬, ë©¤ë²„ ì‘ì—… ë“± ëª¨ë“  ì˜ì—­ì— ì¼ê´€ëœ ì ìš©
  - ì‘ì—… ì‹œì‘ ì‹œ `showInfo`, ì…ë ¥ ì˜¤ë¥˜ ë“± ê²½ê³„ ìƒí™©ì— `showWarning`, ì‹¤íŒ¨ ì‹œ `showError`, ì„±ê³µ ì‹œ `showSuccess` íŒ¨í„´ ì ìš©
  - ì‚¬ìš©ìì—ê²Œ ì¼ê´€ë˜ê³  ëª…í™•í•œ í”¼ë“œë°± ì œê³µìœ¼ë¡œ ì „ì²´ì ì¸ ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

## [1.2.0] - 2024-12-19

### ğŸš€ ì„±ëŠ¥ ìµœì í™”

- **ë¡œê·¸ì¸ í”„ë¡œì„¸ìŠ¤ ëŒ€í­ ê°œì„ **:
  - ë¡œê·¸ì¸ ì‹œë„ íšŸìˆ˜ í™•ì¸ê³¼ Supabase ì¸ì¦ ë³‘ë ¬ ì²˜ë¦¬ (Promise.all)
  - ë¹„ë™ê¸° ì„±ëŠ¥ ë¡œê¹…ìœ¼ë¡œ ì‘ë‹µ ì§€ì—° ë°©ì§€
  - DB ì¿¼ë¦¬ í†µí•©ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ í˜¸ì¶œ ìµœì†Œí™”
  - ì„œë²„ì—ì„œ ì„¸ì…˜ ì¿ í‚¤ ì§ì ‘ ì„¤ì •ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ ì‘ì—… ê°ì†Œ
  - í”„ë¡œí•„ ë¡œë“œ ì¦‰ì‹œ ì¬ì‹œë„ ë° ë°±ê·¸ë¼ìš´ë“œ ë¡œë“œ
  - ì˜ˆìƒ ì„±ëŠ¥ í–¥ìƒ: ë¡œê·¸ì¸ 2-4ì´ˆ â†’ 1-2ì´ˆ, ëŒ€ì‹œë³´ë“œ 3-5ì´ˆ â†’ 2-3ì´ˆ

### ğŸ”§ ê¸°ìˆ ì  ê°œì„ 

- **API ë¼ìš°í„° ìµœì í™”**:
  - ë¡œê·¸ì¸ APIì—ì„œ ë³‘ë ¬ ì²˜ë¦¬ ë„ì…
  - ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ê°•í™”
  - ì—ëŸ¬ ì²˜ë¦¬ ê°œì„  ë° ì•ˆì „ì„± í–¥ìƒ
  - ì„¸ì…˜ ê´€ë¦¬ ìµœì í™”

### ğŸ› ë²„ê·¸ ìˆ˜ì •

- **ë¡œê·¸ì¸ ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ **:
  - `result.user.id` undefined ì—ëŸ¬ ì•ˆì „ ì²˜ë¦¬
  - ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ ì ì ˆí•œ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ

## ğŸ¦ Safari ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ê°œì„ 

#### **Safari íŠ¹ìœ ì˜ ë¬¸ì œì  í•´ê²°**

- **ë¬¸ì œ**: ë°°í¬ í™˜ê²½ Safariì—ì„œ ë¡œê·¸ì¸ ì‹œ ì—ëŸ¬ í˜ì´ì§€ ë°œìƒ
- **ì£¼ìš” ì›ì¸**:
  - í”„ë¼ì´ë¹— ë¸Œë¼ìš°ì§• ëª¨ë“œì—ì„œ localStorage/sessionStorage ì ‘ê·¼ ì œí•œ
  - iOS Safariì˜ ì„¸ì…˜ ìœ ì§€ ë¬¸ì œ
  - crypto.randomUUID() API í˜¸í™˜ì„± ë¶€ì¡±
  - ë‚ ì§œ íŒŒì‹± ë° fetch íƒ€ì„ì•„ì›ƒ ë¬¸ì œ
- **í•´ê²° ë°©ì•ˆ**:

  ```typescript
  // 1. Safari í˜¸í™˜ì„± ìŠ¤í† ë¦¬ì§€ ë˜í¼ êµ¬í˜„
  const safeStorage = safeLocalStorageAccess();
  safeStorage.setItem(key, value); // í”„ë¼ì´ë¹— ëª¨ë“œì—ì„œë„ ì•ˆì „

  // 2. crypto.randomUUID() ëŒ€ì²´ í•¨ìˆ˜
  const uuid = safeRandomUUID(); // Safari êµ¬ë²„ì „ ëŒ€ì‘

  // 3. ë¡œê·¸ì¸ ì¬ì‹œë„ ë¡œì§
  await safariLoginRetry(loginFunction, 3); // 3íšŒ ì¬ì‹œë„

  // 4. Safari íŠ¹ì • ì—ëŸ¬ ì§„ë‹¨
  const diagnosis = diagnoseSafariLoginIssues();
  ```

- **ì¶”ê°€ ê¸°ëŠ¥**:
  - Safari í”„ë¼ì´ë¹— ë¸Œë¼ìš°ì§• ëª¨ë“œ ê°ì§€
  - iOS Safari ë²„ì „ë³„ í˜¸í™˜ì„± ì²´í¬
  - Safari ì „ìš© ì—ëŸ¬ ë¡œê¹… ë° ì§„ë‹¨ ì‹œìŠ¤í…œ
  - ì„¸ì…˜ ë³µêµ¬ ê¸°ëŠ¥

---

## [2025-7-7] - Notification API ReferenceError í•´ê²°

### ğŸ› ì¤‘ìš” ë²„ê·¸ ìˆ˜ì •

#### **Notification API ReferenceError í•´ê²°**

- **ë¬¸ì œ**: Safariì—ì„œ `ReferenceError: Can't find variable: Notification` ì—ëŸ¬ ë°œìƒ
- **ì›ì¸**: Safari ì¼ë¶€ ë²„ì „ì—ì„œ Notification APIê°€ ì „ì—­ ìŠ¤ì½”í”„ì— ì •ì˜ë˜ì§€ ì•ŠìŒ
- **í•´ê²°**:
  ```typescript
  // ì•ˆì „í•œ Notification API ì ‘ê·¼ ë˜í¼ êµ¬í˜„
  const safeNotification = safeNotificationAccess();
  if (safeNotification.isSupported) {
    const permission = await safeNotification.requestPermission();
  }
  ```
- **ì ìš© ë²”ìœ„**:
  - `useNotificationPermission.ts` - ì•Œë¦¼ ê¶Œí•œ ê´€ë¦¬ í›…
  - `useNotificationService.ts` - ì•Œë¦¼ ì„œë¹„ìŠ¤ í›…
  - `WebPushSubscription.tsx` - ì›¹í‘¸ì‹œ êµ¬ë… ì»´í¬ë„ŒíŠ¸
  - `test-push/page.tsx` - í‘¸ì‹œ ì•Œë¦¼ í…ŒìŠ¤íŠ¸ í˜ì´ì§€
- **ì¶”ê°€ ë³´ì™„**: íƒ€ì… ì•ˆì „ì„± í™•ë³´ë¥¼ ìœ„í•´ `NotificationPermission | "unsupported"` íƒ€ì… ì ìš©

---

## [2024-01-XX] - ë£¨íŠ¸ í˜ì´ì§€ ë¦¬íŒ©í† ë§ ì™„ë£Œ

### ìˆ˜ì • ì‚¬í•­

- **ë£¨íŠ¸ í˜ì´ì§€ ë¦¬íŒ©í† ë§**: `app/page.tsx` ì™„ì „íˆ ì¬êµ¬ì„±
  - `HomePageContent` ì»´í¬ë„ŒíŠ¸ ì¶”ì¶œí•˜ì—¬ lint ì˜¤ë¥˜ í•´ê²°
  - ë¬´í•œ ë¡œë”© ì´ìŠˆ ì™„ì „ í•´ê²°
  - ë¹„ì¸ì¦ ì‚¬ìš©ì ëŒ€ìƒ ì¦‰ì‹œ ë Œë”ë§ êµ¬í˜„
  - ì‹œìŠ¤í…œ ì„¤ì • ë¡œë”©ì— ë¬´ê´€í•˜ê²Œ ê¸°ë³¸ê°’ìœ¼ë¡œ ì¦‰ì‹œ í‘œì‹œ

### ê¸°ìˆ ì  ê°œì„ 

- ë¹„ì¸ì¦ ì‚¬ìš©ì ê²½í—˜ ìµœì í™”: ì¸ì¦ ìƒíƒœ í™•ì¸ ì‹œì—ë§Œ ë¡œë”© í‘œì‹œ
- ì‹œìŠ¤í…œ ì„¤ì • ì˜ì¡´ì„± ì œê±°: ì„¤ì • ë¡œë”© ì‹¤íŒ¨ ì‹œì—ë„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì •ìƒ ì‘ë™
- ì¸ì¦ëœ ì‚¬ìš©ì ë¦¬ë‹¤ì´ë ‰íŠ¸ ë¡œì§ ê°œì„ 

### ë²„ê·¸ ìˆ˜ì •

- ë£¨íŠ¸ í˜ì´ì§€ ë¬´í•œ ë¡œë”© ì´ìŠˆ í•´ê²°
- `HomePageContent` ì»´í¬ë„ŒíŠ¸ ì •ì˜ ëˆ„ë½ìœ¼ë¡œ ì¸í•œ lint ì˜¤ë¥˜ ìˆ˜ì •
- ë¹„ì¸ì¦ ì‚¬ìš©ì ëŒ€ìƒ ë¶ˆí•„ìš”í•œ ì„¤ì • ë¡œë”© ëŒ€ê¸° ì œê±°

---

## [2024-01-XX] - ë°©ë¬¸ì í•„í„° ëª¨ë°”ì¼ UI ê°œì„ 

### UI/UX ê°œì„ 

- **ë°©ë¬¸ì í•„í„° ë²„íŠ¼ ëª¨ë°”ì¼ ìµœì í™”**: `components/admin/visitors/components/QuickFilters.tsx`
  - ëª¨ë°”ì¼ì—ì„œ í•„í„° ë²„íŠ¼ í…ìŠ¤íŠ¸ê°€ ì˜ë¦¬ëŠ” ë¬¸ì œ í•´ê²°
  - "ì˜¤ëŠ˜", "7ì¼", "30ì¼", "ì „ì²´" ë²„íŠ¼ í…ìŠ¤íŠ¸ ì™„ì „ í‘œì‹œ
  - ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ ê°œì„ ìœ¼ë¡œ ëª¨ë“  ê¸°ê¸°ì—ì„œ ì½ê¸° ì‰¬ìš´ UI ì œê³µ

### ê¸°ìˆ ì  ê°œì„ 

- ëª¨ë°”ì¼ìš© ì¶•ì•½ í…ìŠ¤íŠ¸ ì œê±°í•˜ê³  ì „ì²´ í…ìŠ¤íŠ¸ í‘œì‹œ
- ë²„íŠ¼ ê°„ê²© ë° íŒ¨ë”© ì¡°ì •ìœ¼ë¡œ í„°ì¹˜ ì¹œí™”ì  UI êµ¬í˜„
- ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ ì»¨í…Œì´ë„ˆë¡œ ì‘ì€ í™”ë©´ì—ì„œë„ ëª¨ë“  í•„í„° ì ‘ê·¼ ê°€ëŠ¥

### ë°˜ì‘í˜• ê°œì„ 

- ëª¨ë°”ì¼: ì „ì²´ í…ìŠ¤íŠ¸ í‘œì‹œ (ì´ì „: ì²« ê¸€ìë§Œ)
- íƒœë¸”ë¦¿: ê¸°ì¡´ ë””ìì¸ ìœ ì§€
- ë°ìŠ¤í¬í†±: ìµœì í™”ëœ ê°„ê²©ê³¼ í¬ê¸°

---

## [2025-1-7] - PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì‹œìŠ¤í…œ ë¶„ì„ ë° ë¬¸ì„œí™”

### ğŸ“± PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì‹œìŠ¤í…œ ìƒì„¸ ë¶„ì„

#### **ì™„ì„±ëœ ë¶„ì„ ë¬¸ì„œ**

- **íŒŒì¼ ìƒì„±**: `docs/pwa-install-prompt-analysis.md`
- **ë¶„ì„ ë²”ìœ„**:
  - ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë° ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°
  - ì´ë²¤íŠ¸ í”Œë¡œìš° ë° ì‚¬ìš©ì ì—¬ì • ë¶„ì„
  - í”Œë«í¼ë³„ ì„¤ì¹˜ ì „ëµ (iOS, Android, Desktop)
  - ì—ì§€ ì¼€ì´ìŠ¤ ë° ì˜ˆì™¸ ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜
  - ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ë° ì¶©ëŒ ë°©ì§€ ë¡œì§

#### **í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ë¶„ì„**

1. **PWAProvider**: ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ê²€ì‚¬ ë° ì„¤ì¹˜ ê°€ëŠ¥ ì—¬ë¶€ íŒë‹¨

   ```typescript
   interface InstallInfo {
     canInstall: boolean;
     platform: "iOS" | "Android" | "Desktop" | "Unknown";
     method: "banner" | "manual" | "none";
     reason?: string;
     isStandalone: boolean;
     userAgent: string;
   }
   ```

2. **DialogManager**: ì‹œìŠ¤í…œ ë‹¤ì´ì–¼ë¡œê·¸ ìš°ì„ ìˆœìœ„ ê´€ë¦¬

   - ì•Œë¦¼ ê¶Œí•œ vs PWA ì„¤ì¹˜ ì¶©ëŒ ë°©ì§€
   - 10ì´ˆ ì§€ì—° í›„ í”„ë¡¬í”„íŠ¸ í‘œì‹œ
   - ë‹¤ì´ì–¼ë¡œê·¸ í ì‹œìŠ¤í…œ í™œìš©

3. **InstallPrompt**: ì‹¤ì œ ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ UI
   - í”Œë«í¼ë³„ ë§ì¶¤í˜• ë©”ì‹œì§€
   - 24ì‹œê°„ ê±°ë¶€ ê¸°ê°„ ê´€ë¦¬
   - framer-motion ì• ë‹ˆë©”ì´ì…˜

#### **í”Œë«í¼ë³„ ì„¤ì¹˜ ì „ëµ**

- **Android Chrome/Edge**: `beforeinstallprompt` ì´ë²¤íŠ¸ + ìë™ ë°°ë„ˆ
- **iOS Safari**: ê³µìœ  ë²„íŠ¼ì„ í†µí•œ ìˆ˜ë™ ì„¤ì¹˜ ì•ˆë‚´
- **Desktop Chrome/Edge**: ì£¼ì†Œì°½ ì„¤ì¹˜ ì•„ì´ì½˜ + í”„ë¡¬í”„íŠ¸
- **ê¸°íƒ€ ë¸Œë¼ìš°ì €**: ì œí•œì  ì§€ì› ë˜ëŠ” ì„¤ì¹˜ ë¶ˆê°€ëŠ¥

#### **ì—ì§€ ì¼€ì´ìŠ¤ ì²˜ë¦¬**

- **ì¶©ëŒ ë°©ì§€**: ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸ì™€ì˜ ìˆœì°¨ ì²˜ë¦¬
- **ì¤‘ë³µ ë°©ì§€**: localStorage ê¸°ë°˜ 24ì‹œê°„ ê±°ë¶€ ê¸°ê°„
- **ë¸Œë¼ìš°ì € í˜¸í™˜ì„±**: User-Agent ê¸°ë°˜ ì„¸ë°€í•œ í”Œë«í¼ ê°ì§€
- **ì„±ëŠ¥ ìµœì í™”**: Context ë©”ëª¨ì´ì œì´ì…˜ ë° ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€

#### **ì‚¬ìš©ì ê²½í—˜ ìµœì í™”**

- **ì ì§„ì  ë…¸ì¶œ ì „ëµ**: í˜ì´ì§€ ë¡œë“œ â†’ 10ì´ˆ ëŒ€ê¸° â†’ ì•Œë¦¼ ê¶Œí•œ ìš°ì„  â†’ PWA ì„¤ì¹˜
- **ì‹œê°ì  ê°œì„ **: ë°˜ì‘í˜• ë””ìì¸, í”Œë«í¼ë³„ ì•„ì´ì½˜, ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜
- **ì ‘ê·¼ì„± ê³ ë ¤**: í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜, ìŠ¤í¬ë¦° ë¦¬ë” ì§€ì›

## [2025-1-7] - PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì¤‘ë³µ í‘œì‹œ ë¬¸ì œ í•´ê²°

### ğŸ› PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì¤‘ë³µ í‘œì‹œ ë²„ê·¸ ìˆ˜ì •

#### **ë¬¸ì œì **

- ì‚¬ìš©ìê°€ PWA ì„¤ì¹˜ í›„ì—ë„ ìƒˆë¡œê³ ì¹¨ ì‹œ ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ê°€ ë°˜ë³µ í‘œì‹œë¨
- ì„¤ì¹˜ ì™„ë£Œ ìƒíƒœê°€ localStorageì— ì €ì¥ë˜ì§€ ì•ŠìŒ
- ê±°ë¶€ ì‹œì—ë§Œ localStorage ì €ì¥, ì„¤ì¹˜ ì‹œì—ëŠ” ì €ì¥í•˜ì§€ ì•ŠìŒ

#### **í•´ê²° ë°©ì•ˆ**

1. **ì„¤ì¹˜ ì™„ë£Œ ìƒíƒœ ì¶”ì  ê°•í™”**

   ```typescript
   // InstallPrompt.tsx - ì„¤ì¹˜ ë²„íŠ¼ í´ë¦­ ì‹œ ìƒíƒœ ì €ì¥
   const handleInstall = () => {
     setShowPrompt(false);
     setIsDismissed(true);
     localStorage.setItem("pwa_install_completed", Date.now().toString());
     onInstall?.();
   };
   ```

2. **PWAProviderì—ì„œ ì„¤ì¹˜ ì™„ë£Œ ìƒíƒœ ì²´í¬**

   ```typescript
   // PWAProvider.tsx - localStorage ì²´í¬ ì¶”ê°€
   const installCompleted = localStorage.getItem("pwa_install_completed");
   if (installCompleted) {
     return {
       canInstall: false,
       reason: "ì´ë¯¸ ì„¤ì¹˜ ì™„ë£Œë¨",
     };
   }
   ```

3. **ë¸Œë¼ìš°ì € ë„¤ì´í‹°ë¸Œ ì´ë²¤íŠ¸ í™œìš©**
   ```typescript
   // beforeinstallprompt/appinstalled ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
   window.addEventListener("appinstalled", handleAppInstalled);
   ```

#### **ê°œì„  íš¨ê³¼**

- âœ… ì„¤ì¹˜ í›„ í”„ë¡¬í”„íŠ¸ ì¤‘ë³µ í‘œì‹œ ë°©ì§€
- âœ… ë‹¤ì¤‘ ê°ì§€ ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ì •í™•ì„± í–¥ìƒ
- âœ… ë¸Œë¼ìš°ì € ë„¤ì´í‹°ë¸Œ ì´ë²¤íŠ¸ í™œìš©ìœ¼ë¡œ ì‹ ë¢°ì„± ì¦ëŒ€
- âœ… localStorage ê¸°ë°˜ ì˜êµ¬ ì„¤ì¹˜ ìƒíƒœ ê´€ë¦¬

---

## [2024-01-XX] - ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸ í ë¡œì§ ì¬í™œì„±í™”

### âœ… ì™„ë£Œì‚¬í•­

- **ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸ í ë¡œì§ ì¬í™œì„±í™”**: Safari í˜¸í™˜ì„± ë¬¸ì œ í•´ê²° í™•ì¸ í›„ DialogManagerì—ì„œ ì•Œë¦¼ ê¶Œí•œ ìš”ì²­ ë‹¤ì´ì–¼ë¡œê·¸ í ë¡œì§ ì¬í™œì„±í™”
- **Safari í˜¸í™˜ì„± ê²€ì¦**: safeNotificationAccess í•¨ìˆ˜ë¥¼ í†µí•œ ë¸Œë¼ìš°ì € í˜¸í™˜ì„± ì²˜ë¦¬ í™•ì¸ ì™„ë£Œ
- **ë‹¤ì´ì–¼ë¡œê·¸ í ìš°ì„ ìˆœìœ„**: ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸(ìš°ì„ ìˆœìœ„ 100) > PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸(ìš°ì„ ìˆœìœ„ 50) ìˆœì„œ ìœ ì§€
- **ì‚¬ìš©ì ê²½í—˜ ê°œì„ **: ë¡œê·¸ì¸ í›„ 2ì´ˆ í›„ ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ, 7ì¼ ê°„ê²© ì¬ìš”ì²­ ë¡œì§ ìœ ì§€

### ğŸ”§ ê¸°ìˆ ì  ë³€ê²½ì‚¬í•­

- `components/common/DialogManager.tsx`: ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸ í ë¡œì§ ì£¼ì„ í•´ì œ ë° ì¬í™œì„±í™”
- Safari ë¸Œë¼ìš°ì €ì—ì„œ ì•Œë¦¼ API í˜¸í™˜ì„± ë¬¸ì œ í•´ê²° í™•ì¸
- localStorageì™€ Notification API ì•ˆì „í•œ ì ‘ê·¼ ë°©ì‹ ì ìš©

### ğŸ“‹ í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

1. **Safari í™˜ê²½ í…ŒìŠ¤íŠ¸**:
   - Safari ë¸Œë¼ìš°ì €ì—ì„œ ë¡œê·¸ì¸ í›„ ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸ ì •ìƒ í‘œì‹œ í™•ì¸
   - í”„ë¼ì´ë¹— ë¸Œë¼ìš°ì§• ëª¨ë“œì—ì„œ ì—ëŸ¬ ì—†ì´ ì²˜ë¦¬ë˜ëŠ”ì§€ í™•ì¸
2. **ë‹¤ì´ì–¼ë¡œê·¸ í ìš°ì„ ìˆœìœ„ í…ŒìŠ¤íŠ¸**:

   - ì•Œë¦¼ ê¶Œí•œ ë‹¤ì´ì–¼ë¡œê·¸ê°€ PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ë³´ë‹¤ ë¨¼ì € í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
   - ì•Œë¦¼ ê¶Œí•œ ì²˜ë¦¬ í›„ PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

3. **ì¬ìš”ì²­ ë¡œì§ í…ŒìŠ¤íŠ¸**:
   - ì•Œë¦¼ ê¶Œí•œ ê±°ë¶€ í›„ 7ì¼ ë’¤ ì¬ìš”ì²­ ë˜ëŠ”ì§€ í™•ì¸
   - ê¶Œí•œ í—ˆìš© í›„ ë” ì´ìƒ ë‹¤ì´ì–¼ë¡œê·¸ê°€ í‘œì‹œë˜ì§€ ì•ŠëŠ”ì§€ í™•ì¸

---

## [2024-01-XX] - PWA ì‚­ì œ ê°ì§€ ë° ì¬ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ê°œì„ 

### âœ… ì™„ë£Œì‚¬í•­

- **PWA ì‚­ì œ ê°ì§€ ê¸°ëŠ¥ ì¶”ê°€**: ì‚¬ìš©ìê°€ í™ˆí™”ë©´ì—ì„œ PWA ì•±ì„ ì‚­ì œí–ˆì„ ë•Œ ê°ì§€í•˜ê³  localStorage ì •ë¦¬
- **ì¬ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì§€ì›**: PWA ì‚­ì œ í›„ ë‹¤ì‹œ ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ í‘œì‹œ ê°€ëŠ¥
- **localStorage ìë™ ì •ë¦¬**: PWA ì‚­ì œ ê°ì§€ ì‹œ `pwa_install_completed`ì™€ `pwa_install_dismissed` ìë™ ì œê±°
- **ì„¤ì¹˜ ìƒíƒœ ê²€ì¦ ê°•í™”**: standalone ëª¨ë“œì™€ beforeinstallprompt ì´ë²¤íŠ¸ ì¡°í•©ìœ¼ë¡œ ì •í™•í•œ ì„¤ì¹˜ ìƒíƒœ íŒë‹¨

### ğŸ”§ ê¸°ìˆ ì  ë³€ê²½ì‚¬í•­

- `components/providers/pwa-provider.tsx`:
  - `checkPWAUninstall()` í•¨ìˆ˜ ì¶”ê°€ë¡œ PWA ì‚­ì œ ê°ì§€
  - `visibilitychange` ì´ë²¤íŠ¸ë¡œ íƒ­ í¬ì»¤ìŠ¤ ì‹œ ì¬ê²€ì¦
  - `beforeinstallprompt` ì´ë²¤íŠ¸ ì¬í™•ì¸ìœ¼ë¡œ ì‚­ì œ ì—¬ë¶€ íŒë‹¨
- `components/common/InstallPrompt.tsx`:
  - ì„¤ì¹˜ ì™„ë£Œ ê¸°ë¡ ê²€ì¦ ê°•í™” (standalone ëª¨ë“œ + ì‹œê°„ ì²´í¬)
  - PWA ì‚­ì œ ê°€ëŠ¥ì„± ê°ì§€ ì‹œ í”„ë¡¬í”„íŠ¸ ì¬í™œì„±í™”

### ğŸ“‹ PWA ì„¤ì¹˜/ì‚­ì œ í”Œë¡œìš°

1. **ì„¤ì¹˜ ì „**:
   - ê±°ë¶€ ì‹œ 24ì‹œê°„ í›„ ì¬ìš”ì²­
   - ì¡°ê±´ ì¶©ì¡± ì‹œ 10ì´ˆ í›„ í”„ë¡¬í”„íŠ¸ í‘œì‹œ
2. **ì„¤ì¹˜ í›„**:
   - `pwa_install_completed` localStorage ì €ì¥
   - `appinstalled` ì´ë²¤íŠ¸ë¡œ ì„¤ì¹˜ ì™„ë£Œ ê°ì§€
   - standalone ëª¨ë“œ í™•ì¸ìœ¼ë¡œ ì„¤ì¹˜ ìƒíƒœ ê²€ì¦
3. **ì‚­ì œ í›„**:
   - `beforeinstallprompt` ì´ë²¤íŠ¸ ì¬ë°œìƒ ê°ì§€
   - localStorage ìë™ ì •ë¦¬ (`pwa_install_completed`, `pwa_install_dismissed`)
   - ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ ì¬í™œì„±í™”

### ğŸ”„ ì•Œë¦¼ ê¶Œí•œ 7ì¼ ì¬ìš”ì²­ ë¡œì§

- **ê±°ë¶€/ë¬´ì‹œ ì‹œ**: localStorageì— íƒ€ì„ìŠ¤íƒ¬í”„ ì €ì¥
- **7ì¼ í›„**: ìë™ìœ¼ë¡œ ë‹¤ì‹œ ìš”ì²­ (ë¡œê·¸ì¸ í›„ 2ì´ˆ ë’¤)
- **í—ˆìš© ì‹œ**: ë” ì´ìƒ ìš”ì²­í•˜ì§€ ì•ŠìŒ
- **ìš°ì„ ìˆœìœ„**: ì•Œë¦¼ ê¶Œí•œ(100) > PWA ì„¤ì¹˜(50)

---
